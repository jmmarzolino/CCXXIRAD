# Plotting
# Load the .eigenvec file & plot the columns you're interested in
pca_MAF_LD <- read.delim("/bigdata/koeniglab/jmarz001/CCXXIRAD/results/pca_MAF_LD.eigenvec")

# replace KL numbers with generation numbers for plotting
pca_MAF_LD$FID <- gsub("24", "F25", pca_MAF_LD$FID)
pca_MAF_LD$FID <- gsub("267", "F11", pca_MAF_LD$FID)

# produce pca colored by generation number
ggplot(pca_MAF_LD, aes(PC1, PC2)) + geom_point(aes(color = pca$FID)) + xlab("PC1 (8.036%)") + theme_minimal() + ylab("PC2 (7.045%)") + scale_color_manual("Generations", values=wes_palette("GrandBudapest1")) + theme(axis.text=element_text(size=12)), axis.title=element_text(size=14,face="bold")


# the smaller grouping to the "right" is made up of about 92 points, which, after filtering, represents about 1/4 of the samples sequenced; is this one of the four plates?
# pca colored by plates
pca_MAF_exclude_10LD$ID <- paste(pca_MAF_exclude_10LD$FID, pca_MAF_exclude_10LD$IID, sep="_")
PCA_Plates <- PCA_Plates[,-c(4:7)]
PCA_Plates2 <- merge(pca_MAF_exclude_10LD, PCA_Plates, sep="_")
ggplot(PCA_Plates, aes(PC1, PC2)) + geom_point(aes(color=PCA_Plates$V1)) + theme_minimal() + scale_color_manual("Plate", values=wes_palette("GrandBudapest1", n=4)) + theme(axis.text=element_text(size=12), axis.title=element_text(size=14, face="bold"))
# the pca clusters do not seem to be based on which plate they were made on/shelf grown on
